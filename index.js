"use strict";(()=>{var oo=Object.defineProperty;var A=(o,e)=>{for(var t in e)oo(o,t,{get:e[t],enumerable:!0})};var _={};A(_,{Flux:()=>no,FluxDispatcher:()=>C,React:()=>d,ReactDOM:()=>ro});var N={};A(N,{find:()=>L,findAll:()=>F,findByDisplayName:()=>O,findByDisplayNameAll:()=>to,findByProps:()=>l,findByPropsAll:()=>eo,modules:()=>R});var $=window.webpackJsonp([],[(o,e,t)=>{o.exports=t}]);var W=(o,e=!1)=>t=>{let n=[];for(let i in o)if(o.hasOwnProperty(i)){let r=o[i].exports;if(!r)continue;if(r.default&&r.__esModule&&t(r.default)){if(e)return r.default;n.push(r.default)}if(t(r)){if(e)return r;n.push(r)}}if(!e)return n},R=$.c,L=W(R,!0),F=W(R),z=o=>e=>o.every(t=>e[t]!==void 0),q=(o,e)=>e?t=>t.displayName===o:t=>t?.default?.displayName===o,l=(...o)=>L(z(o)),eo=(...o)=>F(z(o)),O=(o,e=!0)=>L(q(o,e)),to=(o,e=!0)=>F(q(o,e));var d=l("createElement"),ro=l("render","findDOMNode"),no=l("Store","initialize"),C=l("_isDispatching","dispatch");var P={};A(P,{after:()=>w,before:()=>io,instead:()=>so,unpatchAll:()=>S});var M=["a","b","i"],g=new Map;function J(o,e,t,n,i){let r=g.get(e)?.[o];if(!r)return i?Reflect.construct(e[o],t,n):e[o].apply(n,t);for(let s of r.b.values()){let p=s.call(n,t);Array.isArray(p)&&(t=p)}let c=(...s)=>i?Reflect.construct(r.o,s,n):r.o.apply(n,s);for(let s of r.i.values()){let p=c;c=(...u)=>s.call(n,u,p)}let a=c(...t);for(let s of r.a.values())a=s.call(n,t,a)??a;return a}function j(o,e,t,n){let i=g.get(o),r=i?.[e];return r?.[n].has(t)?(r[n].delete(t),M.every(c=>r[c].size===0)&&(Reflect.defineProperty(o,e,{value:r.o,writable:!0,configurable:!0})||(o[e]=r.o),delete i[e]),Object.keys(i).length==0&&g.delete(o),!0):!1}function S(){for(let[o,e]of g.entries())for(let t in e)for(let n of M)for(let i of e[t]?.[n].keys()??[])j(o,t,i,n)}var T=o=>(e,t,n,i=!1)=>{if(typeof t[e]!="function")throw new Error(`${e} is not a function in ${t.constructor.name}`);g.has(t)||g.set(t,{});let r=g.get(t);if(!r[e]){let s=t[e];r[e]={o:s,b:new Map,i:new Map,a:new Map};let p=(f,h,y)=>{let D=J(e,t,h,f,y);return i&&a(),D},u=new Proxy(s,{apply:(f,h,y)=>p(h,y,!1),construct:(f,h)=>p(s,h,!0),get:(f,h,y)=>h=="toString"?s.toString.bind(s):Reflect.get(f,h,y)});Reflect.defineProperty(t,e,{value:u,configurable:!0,writable:!0})||(t[e]=u)}let c=Symbol(),a=()=>j(t,e,c,o);return r[e][o].set(c,n),a};var io=T("b"),so=T("i"),w=T("a");function I(o){let e=document.createElement("style");return e.id="CORDWOOD_INJECTED_STYLE",e.innerHTML=o,document.head.appendChild(e),()=>{e.remove()}}var V={...P,injectCSS:I};var ao=l("showChangeLog");function U(){w("showChangeLog",ao,()=>{C.dispatch({type:"CHANGE_LOG_OPEN"})})}var co=O("Checkbox"),b=class extends d.Component{constructor(e={}){super(e),this.state={toggled:0}}render(){return d.createElement("div",{className:"margin-top-20"},d.createElement(co,{onChange:e=>console.log(e),value:!1}))}};var x=l("defaultRules","parserFor"),Y=l("getDefaultRules","parserFor"),po=Y.getDefaultRules(),lo=x.defaultRules.lheading,K=x.defaultRules.link,fo=x.defaultRules.image,uo=Y.parserFor({...po,image:{...fo},link:{...K},list:x.defaultRules.list,lheading:{...lo,parse(o,e,t){return{className:/\{(.+?)}/.exec(o[1])[1],level:o[2]==="="?1:2,content:x.parseInline(e,o[1].replace(/\{.+?}/,""),t)}},react(o,e,t){return d.createElement(`h${o.level}`,{key:t.key,className:o.className},e(o.content,t))}},shortlink:{shortlinks:{gh:"github.com",srht:"git.sr.ht"},regex:/^\[(.+?)\]\((.+?):([^\/].+?)\)/,order:K.order-.5,match(o){return this.regex.exec(o)},parse(o,e,t){return{content:x.parseInline(e,o[1],t),target:`https://${this.shortlinks[o[2]]}/${o[3]}`}},react(o,e,t){return d.createElement("a",{href:o.target},e(o.content,t))}}}),Q=({changelog:o})=>d.createElement("div",null,uo(o.body,!1));function v(){U();let o=l("UserSettingsModalSections");Object.assign(o.UserSettingsModalSections,{CORDWOOD:"CORDWOOD",CORDWOOD_CHANGELOG:"CORDWOOD_CHANGELOG"});let e=l("getUserSettingsModalSections");w("getUserSettingsModalSections",e,(n,i)=>{i.push({section:o.UserSettingsModalSections.CORDWOOD,label:"Cordwood",element:b})});let t=l("TabBarItem","TabBarHeader","TabBarSeparator");w("render",e.default.prototype,(n,i)=>{i.props.children[0].props.children.props.children[1].push(d.createElement(t.TabBarHeader,{className:"cordwood-settings-header"},"Cordwood"),d.createElement(t.TabBarItem,{key:"CORDWOOD"},"Plugins"),d.createElement("div",{className:"cordwood-changelog-button",onClick:()=>{ho(),C.dispatch({type:"CHANGE_LOG_OPEN"})}},"Cordwood Change Log")),i.props.children[0].props.children.props.selectedItem==="CORDWOOD"&&(i.props.children[1].props.children[0].props.children=d.createElement(b,null))})}function ho(){let o=O("MarkdownModal");w("render",o.prototype,(e,t)=>{if(!t.props.className.includes("change-log"))return t;let i=window.cordwood.changelog.replace(/\r/g,"").split(`---changelog---
`).slice(1).map(s=>{let p=!1,u={},m=s.split(`
`).filter(f=>{if(f==="---")return p=!0,!1;if(!p){let h=f.split(": "),y=h.shift(),D=h.join(": ");u[y]=JSON.parse(D)}return p}).join(`
`);return{...u,body:m}})[0],r=t.props.children[0].props.children[0];r[0].props.children="Cordwood Changelog",r[1]=` (${i.date})`;let c=t.props.children[2].props.children;c[1].props.href="https://github.com/Cordwood/Cordwood/blob/master/CHANGELOG.md";let a=t.props.children[1];return a.props.children[0]=null,a.props.children[1]=[d.createElement(Q,{changelog:i})],t},!0)}var B=(o,e,t)=>{console[t]("%cCordwood%c",`background-color: ${e}; color: black; font-weight: 600; border-radius: 16px; padding: 0px 5px 0px 5px;`,"",o)},k={log:o=>B(o,"#b6c76c","log"),warn:o=>B(o,"#e19c3d","warn"),error:o=>B(o,"#a63d40","error")};function E(o,e,{walkable:t=[],ignore:n=[],maxDepth:i=100}={}){let r=0;function c(a,s,{walkable:p=[],ignore:u=[]}={}){if(r+=1,!(r>i)){if(typeof s=="string"){if(a.hasOwnProperty(s))return a[s]}else if(s(a))return a;if(!!a){if(Array.isArray(a))for(let m of a){let f=c(m,s,{walkable:p,ignore:u});if(f)return f}else if(typeof a=="object"){for(let m of Object.keys(a))if(!(p!=null&&p.includes(m))&&!u.includes(m))try{let f=c(a[m],s,{walkable:p,ignore:u});if(f)return f}catch{}}}}}return c(o,e,{walkable:t,ignore:n})}function X(o,e){E(o,e,{walkable:["props","children","child","sibling"]})}async function G(o){let e={cache:"no-cache"},t=new URL(o.endsWith("/")?o:o+"/"),n=await fetch(t+"manifest.json",e);if(!n.ok)throw new Error(`Could not load manifest for plugin at ${o}`);let i;try{i=await n.json()}catch{throw new Error(`Could not parse manifest for plugin at ${o}`)}let r;try{r=await(await fetch(t+"index.js",e)).text()}catch{throw new Error(`Could not load main file for plugin at ${o}`)}return{manifest:i,url:t,main:r}}var go=window.eval;async function H(o){window.cordwood.plugins.loaded.push(o);let e=go(o.main)(window.cordwood);e.onLoad&&e.onLoad()}if(window.cordwood)throw new Error("Cordwood is already injected...");var Z=!1;try{v();let o=I(".cordwood-settings-header{padding-bottom:1rem}.cordwood-changelog-button{cursor:pointer;display:block!important;color:#faa61a!important;font-size:12px!important;padding:8px 6px 10px 20px!important;opacity:.7;-webkit-transition:opacity .2s!important;transition:opacity .2s}.cordwood-changelog-button:hover{opacity:1;color:#faa61a}");window.cordwood={utils:{logger:k,findInTree:E,findInReactTree:X},patcher:{...V},webpack:{...N,common:{..._}},plugins:{importPlugin:G,loadPlugin:H,loaded:new Array},uninject:()=>{S(),o(),delete window.cordwood}},fetch("https://raw.githubusercontent.com/Cordwood/Cordwood/master/CHANGELOG.md",{cache:"no-store"}).then(e=>e.text().then(t=>Object.assign(window.cordwood,{changelog:t})))}catch(o){Z=!0,k.error(`Cordwood failed to initialize... ${o.stack?o.stack:o.toString()}`)}Z||k.log("Loaded successfully!");})();
//# sourceURL=Cordwood