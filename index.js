"use strict";(()=>{var oo=Object.defineProperty;var A=(o,t)=>{for(var e in t)oo(o,e,{get:t[e],enumerable:!0})};var M={};A(M,{Flux:()=>no,FluxDispatcher:()=>x,React:()=>l,ReactDOM:()=>ro});var _={};A(_,{find:()=>L,findAll:()=>N,findByDisplayName:()=>C,findByDisplayNameAll:()=>eo,findByProps:()=>d,findByPropsAll:()=>to,modules:()=>R});var $=window.webpackJsonp([],[(o,t,e)=>{o.exports=e}]);var W=(o,t=!1)=>e=>{let n=[];for(let i in o)if(o.hasOwnProperty(i)){let r=o[i].exports;if(!r)continue;if(r.default&&r.__esModule&&e(r.default)){if(t)return r.default;n.push(r.default)}if(e(r)){if(t)return r;n.push(r)}}if(!t)return n},R=$.c,L=W(R,!0),N=W(R),z=o=>t=>o.every(e=>t[e]!==void 0),q=(o,t)=>t?e=>e.displayName===o:e=>e?.default?.displayName===o,d=(...o)=>L(z(o)),to=(...o)=>N(z(o)),C=(o,t=!0)=>L(q(o,t)),eo=(o,t=!0)=>N(q(o,t));var l=d("createElement"),ro=d("render","findDOMNode"),no=d("Store","initialize"),x=d("_isDispatching","dispatch");var U={};A(U,{after:()=>w,before:()=>io,instead:()=>so,unpatchAll:()=>S});var j=["a","b","i"],g=new Map;function J(o,t,e,n,i){let r=g.get(t)?.[o];if(!r)return i?Reflect.construct(t[o],e,n):t[o].apply(n,e);for(let s of r.b.values()){let p=s.call(n,e);Array.isArray(p)&&(e=p)}let c=(...s)=>i?Reflect.construct(r.o,s,n):r.o.apply(n,s);for(let s of r.i.values()){let p=c;c=(...u)=>s.call(n,u,p)}let a=c(...e);for(let s of r.a.values())a=s.call(n,e,a)??a;return a}function F(o,t,e,n){let i=g.get(o),r=i?.[t];return r?.[n].has(e)?(r[n].delete(e),j.every(c=>r[c].size===0)&&(Reflect.defineProperty(o,t,{value:r.o,writable:!0,configurable:!0})||(o[t]=r.o),delete i[t]),Object.keys(i).length==0&&g.delete(o),!0):!1}function S(){for(let[o,t]of g.entries())for(let e in t)for(let n of j)for(let i of t[e]?.[n].keys()??[])F(o,e,i,n)}var k=o=>(t,e,n,i=!1)=>{if(typeof e[t]!="function")throw new Error(`${t} is not a function in ${e.constructor.name}`);g.has(e)||g.set(e,{});let r=g.get(e);if(!r[t]){let s=e[t];r[t]={o:s,b:new Map,i:new Map,a:new Map};let p=(f,h,y)=>{let D=J(t,e,h,f,y);return i&&a(),D},u=new Proxy(s,{apply:(f,h,y)=>p(h,y,!1),construct:(f,h)=>p(s,h,!0),get:(f,h,y)=>h=="toString"?s.toString.bind(s):Reflect.get(f,h,y)});Reflect.defineProperty(e,t,{value:u,configurable:!0,writable:!0})||(e[t]=u)}let c=Symbol(),a=()=>F(e,t,c,o);return r[t][o].set(c,n),a};var io=k("b"),so=k("i"),w=k("a");function v(o){let t=document.createElement("style");return t.id="CORDWOOD_INJECTED_STYLE",t.innerHTML=o,document.head.appendChild(t),()=>{t.remove()}}var V={...U,injectCSS:v};var ao=d("showChangeLog");function B(){w("showChangeLog",ao,()=>{x.dispatch({type:"CHANGE_LOG_OPEN"})})}var co=C("Checkbox"),b=class extends l.Component{constructor(t={}){super(t),this.state={toggled:0}}render(){return l.createElement("div",{className:"margin-top-20"},l.createElement(co,{onChange:t=>console.log(t),value:!1}))}};var O=d("defaultRules","parserFor"),Y=d("getDefaultRules","parserFor"),po=Y.getDefaultRules(),lo=O.defaultRules.lheading,K=O.defaultRules.link,fo=O.defaultRules.image,uo=Y.parserFor({...po,image:{...fo},link:{...K},list:O.defaultRules.list,lheading:{...lo,parse(o,t,e){return{className:/\{(.+?)}/.exec(o[1])[1],level:o[2]==="="?1:2,content:O.parseInline(t,o[1].replace(/\{.+?}/,""),e)}},react(o,t,e){return l.createElement(`h${o.level}`,{key:e.key,className:o.className},t(o.content,e))}},shortlink:{shortlinks:{gh:"github.com",srht:"git.sr.ht"},regex:/^\[(.+?)\]\((.+?):([^\/].+?)\)/,order:K.order-.5,match(o){return this.regex.exec(o)},parse(o,t,e){return{content:O.parseInline(t,o[1],e),target:`https://${this.shortlinks[o[2]]}/${o[3]}`}},react(o,t,e){return l.createElement("a",{href:o.target},t(o.content,e))}}}),Q=({changelog:o})=>l.createElement("div",null,uo(o.body,!1));function I(){B();let o=d("UserSettingsModalSections");Object.assign(o.UserSettingsModalSections,{CORDWOOD:"CORDWOOD",CORDWOOD_CHANGELOG:"CORDWOOD_CHANGELOG"});let t=d("getUserSettingsModalSections");w("getUserSettingsModalSections",t,(n,i)=>{i.push({section:o.UserSettingsModalSections.CORDWOOD,label:"Cordwood",element:b})});let e=d("TabBarItem","TabBarHeader","TabBarSeparator");w("render",t.default.prototype,(n,i)=>{i.props.children[0].props.children.props.children[1].push(l.createElement(e.TabBarHeader,{className:"cordwood-settings-header"},"Cordwood"),l.createElement(e.TabBarItem,{key:"CORDWOOD"},"Plugins"),l.createElement("div",{className:"cordwood-changelog-button",onClick:()=>{ho(),x.dispatch({type:"CHANGE_LOG_OPEN"})}},"Cordwood Change Log")),i.props.children[0].props.children.props.selectedItem==="CORDWOOD"&&(i.props.children[1].props.children[0].props.children=l.createElement(b,null))})}function ho(){let o=C("MarkdownModal");w("render",o.prototype,(t,e)=>{if(!e.props.className.includes("change-log"))return e;let i=window.cordwood.changelog.replace(/\r/g,"").split(`---changelog---
`).slice(1).map(s=>{let p=!1,u={},m=s.split(`
`).filter(f=>{if(f==="---")return p=!0,!1;if(!p){let h=f.split(": "),y=h.shift(),D=h.join(": ");u[y]=JSON.parse(D)}return p}).join(`
`);return{...u,body:m}})[0],r=e.props.children[0].props.children[0];r[0].props.children="Cordwood Changelog",r[1]=` (${i.date})`;let c=e.props.children[2].props.children;c[1].props.href="https://github.com/Cordwood/Cordwood/blob/master/CHANGELOG.md";let a=e.props.children[1];return a.props.children[0]=null,a.props.children[1]=[l.createElement(Q,{changelog:i})],e},!0)}var P=(o,t,e)=>{console[e]("%cCordwood%c",`background-color: ${t}; color: black; font-weight: 600; border-radius: 16px; padding: 0px 5px 0px 5px;`,"",o)},T={log:o=>P(o,"#b6c76c","log"),warn:o=>P(o,"#e19c3d","warn"),error:o=>P(o,"#a63d40","error")};function E(o,t,{walkable:e=[],ignore:n=[],maxDepth:i=100}={}){let r=0;function c(a,s,{walkable:p=[],ignore:u=[]}={}){if(r+=1,!(r>i)){if(typeof s=="string"){if(a.hasOwnProperty(s))return a[s]}else if(s(a))return a;if(!!a){if(Array.isArray(a))for(let m of a){let f=c(m,s,{walkable:p,ignore:u});if(f)return f}else if(typeof a=="object"){for(let m of Object.keys(a))if(!(p!=null&&p.includes(m))&&!u.includes(m))try{let f=c(a[m],s,{walkable:p,ignore:u});if(f)return f}catch{}}}}}return c(o,t,{walkable:e,ignore:n})}function X(o,t){E(o,t,{walkable:["props","children","child","sibling"]})}async function G(o){let t={cache:"no-cache"},e=new URL(o.endsWith("/")?o:o+"/"),n=await fetch(e+"manifest.json",t);if(!n.ok)throw new Error(`Could not load manifest for plugin at ${o}`);let i;try{i=await n.json()}catch{throw new Error(`Could not parse manifest for plugin at ${o}`)}let r;try{r=await(await fetch(e+"index.js",t)).text()}catch{throw new Error(`Could not load main file for plugin at ${o}`)}return{manifest:i,url:e,main:r}}var go=window.eval;async function H(o){window.cordwood.plugins.loaded.push(o);let t=go(o.main)(window.cordwood);t.onLoad&&t.onLoad()}if(window.cordwood)throw new Error("Cordwood is already injected...");var Z=!1;try{I();let o=v(".cordwood-settings-header{padding-bottom:1rem}.cordwood-changelog-button{cursor:pointer;display:block!important;color:#faa61a!important;font-size:12px!important;padding:8px 6px 10px 20px!important;opacity:.7;-webkit-transition:opacity .2s!important;transition:opacity .2s}.cordwood-changelog-button:hover{opacity:1;color:#faa61a}");window.cordwood={utils:{logger:T,findInTree:E,findInReactTree:X},patcher:{...V},webpack:{..._,common:{...M}},plugins:{importPlugin:G,loadPlugin:H,loaded:new Array},uninject:()=>{S(),o(),delete window.cordwood}},fetch("https://raw.githubusercontent.com/Cordwood/Cordwood/master/CHANGELOG.md",{cache:"no-store"}).then(t=>t.text().then(e=>Object.assign(window.cordwood,{changelog:e})))}catch(o){Z=!0,T.error(`Cordwood failed to initialize... ${o.stack?o.stack:o.toString()}`)}Z||T.log("Loaded successfully!");})();
//# sourceURL=Cordwood