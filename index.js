"use strict";(()=>{var Ne=Object.create;var E=Object.defineProperty;var Pe=Object.getOwnPropertyDescriptor;var Le=Object.getOwnPropertyNames;var je=Object.getPrototypeOf,Fe=Object.prototype.hasOwnProperty;var Re=(e,t,o)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var Be=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),U=(e,t)=>{for(var o in t)E(e,o,{get:t[o],enumerable:!0})},Ie=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Le(t))!Fe.call(e,n)&&n!==o&&E(e,n,{get:()=>t[n],enumerable:!(r=Pe(t,n))||r.enumerable});return e};var Ue=(e,t,o)=>(o=e!=null?Ne(je(e)):{},Ie(t||!e||!e.__esModule?E(o,"default",{value:e,enumerable:!0}):o,e));var x=(e,t,o)=>(Re(e,typeof t!="symbol"?t+"":t,o),o);var Te=Be((Yt,F)=>{(function(){"use strict";var e={}.hasOwnProperty;function t(){for(var o=[],r=0;r<arguments.length;r++){var n=arguments[r];if(!!n){var s=typeof n;if(s==="string"||s==="number")o.push(n);else if(Array.isArray(n)){if(n.length){var a=t.apply(null,n);a&&o.push(a)}}else if(s==="object")if(n.toString===Object.prototype.toString)for(var l in n)e.call(n,l)&&n[l]&&o.push(l);else o.push(n.toString())}}return o.join(" ")}typeof F<"u"&&F.exports?(t.default=t,F.exports=t):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return t}):window.classNames=t})()});var $={};U($,{Flux:()=>T,FluxDispatcher:()=>m,React:()=>i,ReactDOM:()=>He});var W={};U(W,{find:()=>G,findAll:()=>H,findByDisplayName:()=>S,findByDisplayNameAll:()=>Ge,findByProps:()=>d,findByPropsAll:()=>Me,modules:()=>M});var ce=window.webpackJsonp([],[(e,t,o)=>{e.exports=o}]);var pe=(e,t=!1)=>o=>{let r=[];for(let n in e)if(e.hasOwnProperty(n)){let s=e[n].exports;if(!s)continue;if(s.default&&s.__esModule&&o(s.default)){if(t)return s.default;r.push(s.default)}if(o(s)){if(t)return s;r.push(s)}}if(!t)return r},M=ce.c,G=pe(M,!0),H=pe(M),de=e=>t=>e.every(o=>t[o]!==void 0),ue=(e,t)=>t?o=>o.displayName===e:o=>o?.default?.displayName===e,d=(...e)=>G(de(e)),Me=(...e)=>H(de(e)),S=(e,t=!0)=>G(ue(e,t)),Ge=(e,t=!0)=>H(ue(e,t));var i=d("createElement"),He=d("render","findDOMNode"),T=d("Store","initialize"),m=d("_isDispatching","dispatch");var J={};U(J,{after:()=>y,before:()=>We,instead:()=>$e,unpatchAll:()=>N});var z=["a","b","i"],g=new Map;function fe(e,t,o,r,n){let s=g.get(t)?.[e];if(!s)return n?Reflect.construct(t[e],o,r):t[e].apply(r,o);for(let c of s.b.values()){let p=c.call(r,o);Array.isArray(p)&&(o=p)}let a=(...c)=>n?Reflect.construct(s.o,c,r):s.o.apply(r,c);for(let c of s.i.values()){let p=a;a=(...f)=>c.call(r,f,p)}let l=a(...o);for(let c of s.a.values())l=c.call(r,o,l)??l;return l}function K(e,t,o,r){let n=g.get(e),s=n?.[t];return s?.[r].has(o)?(s[r].delete(o),z.every(a=>s[a].size===0)&&(Reflect.defineProperty(e,t,{value:s.o,writable:!0,configurable:!0})||(e[t]=s.o),delete n[t]),Object.keys(n).length==0&&g.delete(e),!0):!1}function N(){for(let[e,t]of g.entries())for(let o in t)for(let r of z)for(let n of t[o]?.[r].keys()??[])K(e,o,n,r)}var P=e=>(t,o,r,n=!1)=>{if(typeof o[t]!="function")throw new Error(`${t} is not a function in ${o.constructor.name}`);g.has(o)||g.set(o,{});let s=g.get(o);if(!s[t]){let c=o[t];s[t]={o:c,b:new Map,i:new Map,a:new Map};let p=(u,h,b)=>{let I=fe(t,o,h,u,b);return n&&l(),I},f=new Proxy(c,{apply:(u,h,b)=>p(h,b,!1),construct:(u,h)=>p(c,h,!0),get:(u,h,b)=>h=="toString"?c.toString.bind(c):Reflect.get(u,h,b)});Reflect.defineProperty(o,t,{value:f,configurable:!0,writable:!0})||(o[t]=f)}let a=Symbol(),l=()=>K(o,t,a,e);return s[t][e].set(a,r),l};var We=P("b"),$e=P("i"),y=P("a");var he=new Array;function ze(e){let t=document.createElement("style");t.id="CORDWOOD_INJECTED_STYLE",t.innerHTML=e,document.head.appendChild(t),he.push(o);function o(){t.remove()}return o}function V(){for(let e of he)e()}var me={...J,injectCSS:ze,clearStyles:V};var Ke=d("showChangeLog");function Y(){y("showChangeLog",Ke,()=>{m.dispatch({type:"CHANGE_LOG_OPEN"})})}function Je(e,t,o){if(e===t)return!0;let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++){let a=r[s];if(e[a]!==t[a]&&(o==null||o.indexOf(a)===-1))return!1}return!0}function Ve(e){return e.displayName||e.name||"Component"}function q(e,t){return o=>class extends i.Component{static displayName=`FluxContainer(${Ve(o)})`;constructor(r){super(r),this.state=t(r),this._handleStoreChange=this._handleStoreChange.bind(this)}_handleStoreChange(){this.setState(t(this.props))}componentWillMount(){e.forEach(r=>{r.addChangeListener(this._handleStoreChange)})}componentWillReceiveProps(r){Je(this.props,r)||this.setState(t(r))}componentWillUnmount(){e.forEach(r=>r.removeChangeListener(this._handleStoreChange))}render(){return i.createElement(o,{...this.props,...this.state},null)}}}function D(e){return new Promise((t,o)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>o(e.error)})}function Ye(e,t){let o=indexedDB.open(e);o.onupgradeneeded=()=>o.result.createObjectStore(t);let r=D(o);return(n,s)=>r.then(a=>s(a.transaction(t,n).objectStore(t)))}var Z;function L(){return Z||(Z=Ye("keyval-store","keyval")),Z}function ge(e,t=L()){return t("readonly",o=>D(o.get(e)))}function ye(e,t,o=L()){return o("readwrite",r=>(r.put(t,e),D(r.transaction)))}function we(e,t=L()){return t("readwrite",o=>(o.delete(e),D(o.transaction)))}function _e(e=L()){return e("readwrite",t=>(t.clear(),D(t.transaction)))}var Q=class{async get(t,o=null){let r=await ge(t);return r||(r=o),r}async set(t,o){await ye(t,o)}async remove(t){await we(t)}async clear(){await _e()}},C=new Q;var xe="CordwoodSettingsStore",X={fluxLogger:!1};async function Se(e){let t=!1,o={};for(let[r,n]of Object.entries(e))n!=null&&(t=!0,X[r]=n),o[r]=X[r];return t&&await C.set(xe,o),t}var ee=class extends T.Store{constructor(t,o){super(t,o)}async initialize(){let t=await C.get(xe);t!=null&&await Se(t)}get fluxLogger(){return X.fluxLogger}},A=new ee(m,async e=>{switch(e.type){case"CORDWOOD_SETTINGS_UPDATE":return await Se(e.settings);default:return!1}});var Ce={setFlux(e){m.dispatch({type:"CORDWOOD_SETTINGS_UPDATE",settings:{fluxLogger:e}})}};var qe=S("Scroller"),Ze=S("Checkbox"),j=class extends i.Component{constructor(t={}){super(t)}render(){return i.createElement(qe,{className:"settings-wrapper settings-panel"},i.createElement("div",{className:"control-groups"},i.createElement("div",{className:"control-group"},i.createElement("label",null,"Debug Settings"),i.createElement("ul",{className:"checkbox-group"},i.createElement("li",null,i.createElement(Ze,{onChange:t=>{Ce.setFlux(t.target.checked)},defaultChecked:this.props.fluxLogger},"Log everything that passes through the Flux Dispatcher.")),i.createElement("li",null,i.createElement("div",{className:"help-text"},"Note that this will clog up your console."))))))}};x(j,"displayName","SettingsView");var te=q([A],()=>({fluxLogger:A.fluxLogger}))(j);var O=d("defaultRules","parserFor"),Oe=d("getDefaultRules","parserFor"),Qe=Oe.getDefaultRules(),Xe=O.defaultRules.lheading,be=O.defaultRules.link,et=O.defaultRules.image,tt=Oe.parserFor({...Qe,image:{...et},link:{...be},list:O.defaultRules.list,lheading:{...Xe,parse(e,t,o){return{className:/\{(.+?)}/.exec(e[1])[1],level:e[2]==="="?1:2,content:O.parseInline(t,e[1].replace(/\{.+?}/,""),o)}},react(e,t,o){return i.createElement(`h${e.level}`,{key:o.key,className:e.className},t(e.content,o))}},shortlink:{shortlinks:{gh:"github.com",srht:"git.sr.ht"},regex:/^\[(.+?)\]\((.+?):([^\/].+?)\)/,order:be.order-.5,match(e){return this.regex.exec(e)},parse(e,t,o){return{content:O.parseInline(t,e[1],o),target:`https://${this.shortlinks[e[2]]}/${e[3]}`}},react(e,t,o){return i.createElement("a",{href:e.target},t(e.content,o))}}}),ke=({changelog:e})=>i.createElement("div",null,tt(e.body,!1));var ot="._cordwood-settings-header_1mzwv_1{paddingbottom:1rem}._cordwood-changelog-button_1mzwv_1{display:block;color:#faa61a;font-size:12px;padding:8px 6px 10px 20px;cursor:pointer;opacity:.7;-webkit-transition:opacity .2s ease;transition:opacity .2s ease}._cordwood-changelog-button_1mzwv_1:hover{opacity:1;color:#faa61a}";document.head.appendChild(document.createElement("style")).appendChild(document.createTextNode(ot));var oe={cordwoodSettingsHeader:"_cordwood-settings-header_1mzwv_1",cordwoodChangelogButton:"_cordwood-changelog-button_1mzwv_1"};var De=Ue(Te());var rt="._defaultColor_1k2t4_1{color:#4f545c}._h1_1k2t4_1{font-size:20px;line-height:24px}._h1_1k2t4_1,._h1_1k2t4_1 ._h2_1k2t4_1{font-weight:500}._h2_1k2t4_1{font-size:16px;line-height:20px;text-transform:uppercase}._h3_1k2t4_1{line-height:24px;font-weight:400}._h3_1k2t4_1,._h3_1k2t4_1 ._h4_1k2t4_1{font-size:16px}._h4_1k2t4_1{line-height:20px;letter-spacing:.3px}._h4_1k2t4_1,._h4_1k2t4_1 ._h5_1k2t4_1{font-weight:500;text-transform:uppercase}._h5_1k2t4_1{font-size:12px;line-height:16px}._faded_1k2t4_1{color:rgba(114,118,126,.6)}";document.head.appendChild(document.createElement("style")).appendChild(document.createTextNode(rt));var R={defaultColor:"_defaultColor_1k2t4_1",h1:"_h1_1k2t4_1",h2:"_h2_1k2t4_1",h3:"_h3_1k2t4_1",h4:"_h4_1k2t4_1",h5:"_h5_1k2t4_1",faded:"_faded_1k2t4_1"};var Ae=(s=>(s.H1="h1",s.H2="h2",s.H3="h3",s.H4="h4",s.H5="h5",s))(Ae||{}),w=class extends i.PureComponent{render(){let{tag:t,className:o,children:r,faded:n,...s}=this.props,a=!s.color&&t!=="h5"?R.defaultColor:null;return i.createElement(t,{className:(0,De.default)(R[t],o,a,{[R.faded]:n}),...s},r)}};x(w,"displayName","FormTitle"),x(w,"Tags",Ae),x(w,"defaultProps",{tag:"h5"});var nt=S("Scroller"),k=class extends i.Component{render(){return i.createElement(nt,{className:"settings-wrapper settings-panel"},i.createElement(w,{tag:w.Tags.H1},"Cordwood"))}};x(k,"displayName","AboutView");function re(){Y();let e=d("UserSettingsModalSections");Object.assign(e.UserSettingsModalSections,{CORDWOOD_ABOUT:"CORDWOOD_ABOUT",CORDWOOD_SETTINGS:"CORDWOOD_SETTINGS",CORDWOOD_PLUGINS:"CORDWOOD_PLUGINS"});let t=d("getUserSettingsModalSections");y("getUserSettingsModalSections",t,(r,n)=>{n.push({section:e.UserSettingsModalSections.CORDWOOD_SETTINGS,label:"Cordwood",element:te})});let o=d("TabBarItem","TabBarHeader","TabBarSeparator");y("render",t.default.prototype,(r,n)=>{n.props.children[0].props.children.props.children[1].push(i.createElement(o.TabBarHeader,{className:oe.cordwoodSettingsHeader},"Cordwood"),i.createElement(o.TabBarItem,{key:"CORDWOOD_ABOUT"},"About"),i.createElement(o.TabBarItem,{key:"CORDWOOD_SETTINGS"},"Settings"),i.createElement("div",{className:oe.cordwoodChangelogButton,onClick:()=>{st(),m.dispatch({type:"CHANGE_LOG_OPEN"})}},"Cordwood Change Log")),n.props.children[0].props.children.props.selectedItem==="CORDWOOD_ABOUT"&&(n.props.children[1].props.children[0].props.children=i.createElement(k,null)),n.props.children[0].props.children.props.selectedItem==="CORDWOOD_SETTINGS"&&(n.props.children[1].props.children[0].props.children=i.createElement(te,null))})}function st(){let e=S("MarkdownModal");y("render",e.prototype,(t,o)=>{if(!o.props.className.includes("change-log"))return o;let n=window.cordwood.changelog.replace(/\r/g,"").split(`---changelog---
`).slice(1).map(c=>{let p=!1,f={},_=c.split(`
`).filter(u=>{if(u==="---")return p=!0,!1;if(!p){let h=u.split(": "),b=h.shift(),I=h.join(": ");f[b]=JSON.parse(I)}return p}).join(`
`);return{...f,body:_}})[0],s=o.props.children[0].props.children[0];s[0].props.children="Cordwood Changelog",s[1]=` (${n.date})`;let a=o.props.children[2].props.children;a[1].props.href="https://github.com/Cordwood/Cordwood/blob/master/CHANGELOG.md";let l=o.props.children[1];return l.props.children[0]=null,l.props.children[1]=[i.createElement(ke,{changelog:n})],o},!0)}var ne=(e,t,o)=>{console[o]("%cCordwood%c",`background-color: ${t}; color: black; font-weight: 600; border-radius: 16px; padding: 0px 5px 0px 5px;`,"",e)},B={log:e=>ne(e,"#b6c76c","log"),warn:e=>ne(e,"#e19c3d","warn"),error:e=>ne(e,"#a63d40","error")};function v(e,t,{walkable:o=[],ignore:r=[],maxDepth:n=100}={}){let s=0;function a(l,c,{walkable:p=[],ignore:f=[]}={}){if(s+=1,!(s>n)){if(typeof c=="string"){if(l.hasOwnProperty(c))return l[c]}else if(c(l))return l;if(!!l){if(Array.isArray(l))for(let _ of l){let u=a(_,c,{walkable:p,ignore:f});if(u)return u}else if(typeof l=="object"){for(let _ of Object.keys(l))if(!(p!=null&&p.includes(_))&&!f.includes(_))try{let u=a(l[_],c,{walkable:p,ignore:f});if(u)return u}catch{}}}}}return a(e,t,{walkable:o,ignore:r})}function se(e,t){v(e,t,{walkable:["props","children","child","sibling"]})}function ie(e){let t=new Array;for(let[o,r]of Object.entries(e)){let n=Object.entries(r).map(([s,a])=>`${s.replace(/[A-Z]/g,l=>`-${l.toLowerCase()}`)}:${a}`).join(";");t.push(`${o}{${n}}`)}return t.join("")}async function ae(e){let t={cache:"no-cache"},o=new URL(e.endsWith("/")?e:e+"/"),r=await fetch(o+"manifest.json",t);if(!r.ok)throw new Error(`Could not load manifest for plugin at ${e}`);let n;try{n=await r.json()}catch{throw new Error(`Could not parse manifest for plugin at ${e}`)}let s;try{s=await(await fetch(o+"index.js",t)).text()}catch{throw new Error(`Could not load main file for plugin at ${e}`)}return{manifest:n,url:o,main:s}}var it=window.eval;async function le(e){window.cordwood.plugins.loaded.push(e);let t=it(e.main)(window.cordwood);t.onLoad&&t.onLoad()}var ve=()=>y("dispatch",m,e=>{A.fluxLogger&&console.log(e[0])});if(window.cordwood)throw new Error("Cordwood is already injected...");var Ee=!1;try{re(),T.initialize(),ve(),window.cordwood={utils:{logger:B,findInTree:v,findInReactTree:se,storage:{get:C.get,set:C.set,remove:C.remove,clear:C.clear},createStyle:ie},patcher:{...me},webpack:{...W,common:{...$}},plugins:{importPlugin:ae,loadPlugin:le,loaded:new Array},uninject:()=>{N(),V(),delete window.cordwood}},fetch("https://raw.githubusercontent.com/Cordwood/Cordwood/master/CHANGELOG.md",{cache:"no-store"}).then(e=>e.text().then(t=>Object.assign(window.cordwood,{changelog:t})))}catch(e){Ee=!0,B.error(`Cordwood failed to initialize... ${e.stack?e.stack:e.toString()}`)}Ee||B.log("Loaded successfully!");})();
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
//# sourceURL=Cordwood